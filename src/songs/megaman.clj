(def tempo 0.333333)

(defn mmbass1 [time note]
  [{:time (* time tempo)  :length (* tempo 0.45) :pitch note}
   {:time (* tempo (+ 0.5 time)) :length (* tempo 0.2) :pitch note}
   {:time (* tempo (+ 0.75 time)) :length (* tempo 0.2) :pitch note}])

(defn mmbass2 [time]
  (concat
   (apply concat
          (for [[beat note]
                [[0 61] [1 61] [2 61] [3 61] [4 61] [5 61] [6 61] [7 61]
                 [8 57] [9 57] [10 57] [11 57] [12 57] [13 57] [14 57] [15 57]
                 [16 59] [17 59] [18 59] [19 59] [20 59] [21 59] [22 59] [23 59]
                 [24 61] [25 61] [26 61] [27 61] [28 61] [29 61] [30 61]]]
            (mmbass1 (+ time beat) note)))
   [{:time (* tempo (+ 31 time)) :length (* tempo 0.45) :pitch 59}
    {:time (* tempo (+ 31.5 time)) :length (* tempo 0.75) :pitch 61}]))

(defn mmbass3 [time]
  (into []
        (for [[beat length note]
              [[0 0.45 62] [0.5 0.2 62] [0.75 0.2 62] [1 0.45 62] [1.5 0.2 62]
               [1.75 0.2 62] [2 0.45 62] [2.5 0.2 69] [2.75 0.2 69] [3 0.2 66]
               [3.25 0.2 66] [3.5 0.45 66] [4.5 0.2 62] [4.75 0.2 62] [5 0.45 66]
               [5.5 0.2 62] [5.75 0.2 62] [6 0.4 73] [6.5 0.2 66] [6.75 0.2 66]
               [7 0.45 69] [7.5 0.2 62] [7.75 0.2 62]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(defn mmbass4 [time]
  (into []
        (for [[beat length note]
              [[0 0.45 61] [0.5 0.2 61] [0.75 0.2 61] [1 0.45 61] [1.5 0.2 61]
               [1.75 0.2 61] [2 0.45 61] [2.5 0.2 68] [2.75 0.2 68] [3 0.2 64]
               [3.25 0.2 64] [3.5 0.45 71] [4.5 0.2 61] [4.75 0.2 61] [5 0.45 64]
               [5.5 0.2 61] [5.75 0.2 61] [6 0.45 71] [6.5 0.2 64] [6.75 0.2 64]
               [7 0.45 68] [7.5 0.2 61] [7.75 0.2 61]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(defn mmbass5 [time]
  (into []
        (for [[beat length note]
              [[0 0.45 59] [0.5 0.2 59] [0.75 0.2 59] [1 0.45 59] [1.5 0.2 59]
               [1.75 0.2 59] [2 0.45 59] [2.5 0.2 59] [2.75 0.2 59] [3 0.45 59]
               [3.5 0.45 60] [4.5 0.45 60] [5 0.45 60] [5.5 0.45 60] [6 0.95 60]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(defn mmbass6 [time]
  (into []
        (for [[beat length note]
              [[0.25 0.2 57] [0.5 0.2 57] [0.75 0.45 57] [1.25 0.2 57] [1.5 0.2 57]
               [1.75 0.45 57] [2.25 0.2 57] [2.5 0.2 57] [2.75 0.45 57] [3.25 0.95 59]
               [4.25 0.2 59] [4.5 0.2 59] [4.75 0.45 59] [5.25 0.2 59] [5.5 0.2 59]
               [5.75 0.45 59] [6.25 0.2 59] [6.5 0.2 59] [6.75 0.45 59] [7.25 0.95 49]
               [8.25 0.45 61] [8.75 0.45 51] [9.25 0.45 63] [9.75 0.45 52] [10.25 0.45 64]
               [10.75 0.45 51] [11.25 0.95 49] [12.25 0.45 61] [12.75 0.45 51] [13.25 0.45 63]
               [13.75 0.45 52] [14.25 0.45 64] [14.75 0.45 51] [15.25 0.95 57]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(defn mmbass7 [time]
  (into []
        (for [[beat length note]
              [[0 0.95 61] [1 0.05 66] [1.05 0.05 64] [1.1 0.05 62] [1.15 0.05 61]
               [1.25 0.05 66] [1.3 0.05 64] [1.35 0.05 62] [1.4 0.05 61] [1.5 0.05 65]
               [1.55 0.05 63] [1.6 0.05 62] [1.65 0.05 60] [1.75 0.05 65] [1.8 0.05 63]
               [1.85 0.05 62] [1.9 0.05 60] [2 0.05 63] [2.05 0.05 62] [2.1 0.05 60]
               [2.15 0.05 59] [2.25 0.05 63] [2.3 0.05 62] [2.35 0.05 60] [2.4 0.05 59]
               [2.5 0.05 62] [2.55 0.05 61] [2.6 0.05 60] [2.65 0.05 58] [2.75 0.05 62]
               [2.8 0.05 61] [2.85 0.05 60] [2.9 0.05 58] [3 0.45 59] [3.5 0.95 61]
               [4.5 0.45 59] [5 0.95 61] [6 0.45 59] [6.5 0.45 60] [7 0.95 61]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(def mmbass
  (concat (mmbass2 0) (rest (mmbass2 32))
          (rest (mmbass3 64)) (mmbass4 72) (mmbass3 80) (mmbass5 88)
          (mmbass2 96) (rest (mmbass2 128))
          (rest (mmbass3 160)) (mmbass4 168) (mmbass3 176) (mmbass5 184)
          [{:time (* tempo 191.5) :length (* tempo 0.95) :pitch 57}]
          (mmbass6 192.25) (take 18 (mmbass6 208.25))
          [{:time (* tempo 215) :length (* tempo 0.75) :pitch 60}]
          (mmbass7 216)))

(defn mmdrums [time]
  [{:length 0.05 :time (* tempo (+ time 0))}
   {:length 0.05 :time (* tempo (+ time 0.5))}
   {:length 0.05 :time (* tempo (+ time 0.75))}
   {:length 0.2 :time (* tempo (+ time 1))}
   {:length 0.05 :time (* tempo (+ time 1.5))}
   {:length 0.05 :time (* tempo (+ time 1.75))}])

(defn mm-lead1 [time]
  (into []
        (for [[beat length note]
              [[0 0.5 61] [0.5 0.25 64] [0.75 0.25 64] [1 0.5 64] [1.5 0.25 64]
               [1.75 0.25 64] [2 0.5 64] [2.5 0.5 61]  [3.5 0.25 61] [3.75 0.25 61]
               [4 0.5 64] [4.5 0.25 64] [4.75 0.25 64] [5 0.5 64] [5.5 0.5 61]
               [6.5 0.5 68] [7 0.5 66] [7.5 0.5 68] [8.5 0.25 64] [8.75 0.25 64]
               [9 0.5 64] [9.5 0.25 64] [9.75 0.25 64] [10 0.5 64] [10.5 0.5 61]
               [11.5 0.5 68] [12.5 0.5 66] [13.5 0.5 64] [14.5 0.5 66] [16.5 0.25 66]
               [16.75 0.25 66] [17 0.5 66] [17.5 0.25 66] [17.75 0.25 66] [18 0.5 66]
               [18.5 0.5 63] [19.5 0.5 68] [20.5 0.5 66] [21.5 0.5 64] [22.5 0.5 63]
               [23.5 0.5 61] [24.5 0.5 61] [25 0.5 68] [25.5 0.5 71] [26 1.5 70]
               [27.5 0.5 61] [28.5 0.5 61] [29 0.5 68] [29.5 0.5 71] [30 1.5 70]
               [31 0.5 75] [31.5 0.5 76]]]
          {:time (* tempo (+ beat time)) :length (* tempo (* 0.9 length)) :pitch note})))

(defn mm-lead1a [time]
  (into []
        (for [[beat length note]
              [[0.5 0.25 61] [0.75 0.25 61] [1 0.5 61] [1.5 0.25 61] [1.75 0.25 61]
               [2 0.5 61] [2.5 0.5 56] [3.5 0.25 56] [3.75 0.25 56]
               [4 0.5 61] [4.5 0.25 61] [4.75 0.25 61] [5 0.5 61] [5.5 0.5 56]
               [6.5 0.5 64] [7 0.5 63] [7.5 0.5 64] [8.5 0.25 61] [8.75 0.25 61]
               [9 0.5 61] [9.5 0.25 61] [9.75 0.25 61] [10 0.5 61] [10.5 0.5 56]
               [11.5 0.5 64] [12.5 0.5 63] [13.5 0.5 61] [14.5 0.5 63] [16.5 0.25 63]
               [16.75 0.25 63] [17 0.5 63] [17.5 0.25 63] [17.75 0.25 63] [18 0.5 63]
               [18.5 0.5 59] [19.5 0.5 64] [20.5 0.5 63] [21.5 0.5 61] [22.5 0.5 59]
               [24 0.5 61] [25 0.5 61] [25.5 0.5 68] [26 0.5 71] [26.5 1 70] [28 0.5 61]
               [29 0.5 61] [29.5 0.5 68] [30 0.5 71] [30.5 1 70] [31 1 71] [31.5 0.5 73]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(defn mm-lead2 [time]
  (into []
        (for [[beat length note]
              [[0 3.25 73] [3.5 0.5 71] [4 1 76] [5 1 73] [6 1 71] [7 1 73] [8.5 2 71]
               [10.5 0.5 71] [11 1.5 73] [12.5 0.5 68] [13 0.5 69] [13.5 0.5 68] [14 0.5 64]
               [15 0.5 64] [15.5 0.5 68] [16 0.5 71] [16.5 3.25 73] [19.5 0.5 71] [20 1.5 76]
               [21 1 73] [22 1 71] [23 1.5 73] [24.5 2 71] [26.5 0.5 71] [27 0.5 68]
               [27.5 0.5 71] [28 0.5 72] [29 0.5 72] [29.5 0.5 72] [30 0.5 75] [30.5 1.5 80]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(defn mm-lead3 [time]
  (into []
        (for [[beat length note]
              [[0 3 56] [3 0.5 54] [3.5 1 59] [4.5 1 57] [5.5 1 56] [6.5 1 57] [7.5 3.5 56]
               [11 0.5 54] [11.5 1 59] [12.5 1 57] [13.5 1 56] [14.5 1 57] [15.5 2.5 52]
               [18 0.5 52] [18.5 0.5 54] [19 0.5 56] [19.5 3 51]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note
           :vibrato {:speed 10 :depth 0.75}})))

(defn mm-lead4 [time]
  (into []
        (for [[beat length note]
              [[0 2 73] [2.5 1 73] [3.5 0.5 71] [4 0.5 73] [5 1.5 76] [6.5 0.5 80]
               [7 0.5 78] [7.5 0.5 76] [8 0.5 75] [8.5 1.5 73] [10.5 1 73] [11.5 0.5 71]
               [12 0.5 73] [13 1.5 76] [14.5 0.5 76] [15 0.5 78] [15.5 1 76]
               [16.5 2 75] [18.5 0.5 75] [19 0.5 73] [19.5 0.5 71] [20 1.5 80] [21.5 1 78]
               [22.5 1 76] [23.5 1 75] [24.5 0.5 75] [25 0.5 76] [25.5 0.5 75] [26 3 73]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note
           :vibrato {:speed 6 :depth 3}})))

(defn mm-lead5 [time]
  (into []
        (for [[beat length note]
              [[0 0.5 64] [1 0.5 64] [1.5 0.5 64] [2 0.5 63] [2.5 1 64] [3.5 0.5 73]
               [4 1 71] [5 1 69] [6 1 68] [7 1 66] [8 0.5 66] [9 0.5 68] [9.5 0.5 68]
               [10.5 0.5 68] [12 0.5 66] [13 0.5 68] [13.5 0.5 68] [14.5 0.5 68]
               [15.5 0.5 66] [16 0.5 64] [17 0.5 64] [17.5 0.5 64] [18 0.5 63] [18.5 1 64]
               [19.5 0.5 73] [20 1 71] [21 1 69] [22 1 68] [23 1 66] [24.5 0.5 63]
               [25 0.5 64] [25.5 0.5 63] [26 3 61]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

(defn mm-lead5a [time]
  (into []
        (for [[beat length note]
              [[0 0.5 61] [1 0.5 61] [1.5 0.5 61] [2 0.5 59] [2.5 1 61] [3.5 0.5 69]
               [4 1 66] [5 1 66] [6 1 64] [7 1 63] [8 0.5 63] [9 0.5 64] [9.5 0.5 64]
               [10.5 0.5 64] [12 0.5 63] [13 0.5 64] [13.5 0.5 64] [14.5 0.5 64]
               [15.5 0.5 63] [16 0.5 61] [17 0.5 61] [17.5 0.5 61] [18 0.5 59] [18.5 1 61]
               [19.5 0.5 69] [20 1 66] [21 1 66] [22 1 64] [23 1 63] [24.5 0.5 59]
               [25 0.5 61] [25.5 0.5 59] [26 3 56]]]
          {:time (* tempo (+ beat time)) :length (* tempo length) :pitch note})))

