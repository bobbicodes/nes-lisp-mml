const nsfFormat = [0x4e, 0x45, 0x53, 0x4d, 0x1a]
const version = 1
let totalSongs = 1
let startingSong = 1
const loadAdr = [0x00, 0x80]
const initAdr = [0x00, 0x80]
const playAdr = [0x09, 0x80]

function pad32(string) {
  let name = []
  for (let i = 0; i < 32; i++) {
    if (i < string.length) {
        name.push(string.charCodeAt(i))
    } else {
      name.push(0)
    }
  }
  return name
}

let songName = pad32("Untitled")
let artist = pad32("Unknown")
let copyright = pad32("")

let ntscSpeed = [0xff, 0x40]
let banking = [0,0,0,0,0,0,0,0]
let palSpeed = [0x1d, 0x4e]
let playMode = 3
let expansionAudio = 0
let prgLength = 0

let header = nsfFormat
header.push(version, totalSongs, startingSong);
header = header.concat(loadAdr, initAdr, playAdr,
  songName, artist, copyright, ntscSpeed, banking,
  palSpeed, playMode, expansionAudio, prgLength)

const load = [0x20, 0x0B, 0x80, 0x20, 0x39, 0x80, 0x60, 0x20, 0x88, 0x80, 0x60];
const init = [0xA9, 0x0F, 0x8D, 0x15, 0x40, 0xA9, 0x00, 0x8D, 0x00, 0x02,
    0xA9, 0xFF, 0x8D, 0x03, 0x02, 0x8D, 0x04, 0x02];
const silence = [0xA9, 0x30, 0x8D, 0x05, 0x02, 0x8D, 0x09, 0x02,
    0x8D, 0x11, 0x02, 0xA9, 0x80, 0x8D, 0x0D, 0x02, 0x60];

const soundLoad = [
	// Offset 0x000000B9 to 0x00000107
	0x8D, 0x01, 0x02, 0x0A, 0xA8, 0xB9, 0x27, 0x82, 0x85, 0x00, 0xB9, 0x28,
	0x82, 0x85, 0x01, 0xA0, 0x00, 0xB1, 0x00, 0x8D, 0x02, 0x02, 0xC8, 0xB1,
	0x00, 0xAA, 0xC8, 0xB1, 0x00, 0x9D, 0x1B, 0x02, 0xF0, 0x20, 0xC8, 0xB1,
	0x00, 0x9D, 0x21, 0x02, 0xC8, 0xB1, 0x00, 0x9D, 0x33, 0x02, 0xC8, 0xB1,
	0x00, 0x9D, 0x27, 0x02, 0xC8, 0xB1, 0x00, 0x9D, 0x2D, 0x02, 0xA9, 0x01,
	0x9D, 0x45, 0x02, 0x9D, 0x4B, 0x02, 0xC8, 0xAD, 0x01, 0x02, 0x9D, 0x15,
	0x02, 0xCE, 0x02, 0x02, 0xD0, 0xC9, 0x60
];

const playFrame = [
	// Offset 0x00000108 to 0x00000132
	0xAD, 0x00, 0x02, 0xD0, 0x25, 0x20, 0x1D, 0x80, 0xA2, 0x00, 0xBD, 0x1B,
	0x02, 0x29, 0x01, 0xF0, 0x11, 0xDE, 0x45, 0x02, 0xD0, 0x09, 0xBD, 0x4B,
	0x02, 0x9D, 0x45, 0x02, 0x20, 0xB3, 0x80, 0x20, 0x8D, 0x81, 0xE8, 0xE0,
	0x06, 0xD0, 0xE3, 0x20, 0xC2, 0x81, 0x60
];

const fetchByte = [
	// Offset 0x00000133 to 0x000001E0
	0xBD, 0x27, 0x02, 0x85, 0x00, 0xBD, 0x2D, 0x02, 0x85, 0x01, 0xA0, 0x00,
	0xB1, 0x00, 0x10, 0x68, 0xC9, 0xE0, 0x90, 0x23, 0xC9, 0xF0, 0x90, 0x32,
	0xC9, 0xF4, 0x90, 0x42, 0xBD, 0x1B, 0x02, 0x29, 0xFE, 0x9D, 0x1B, 0x02,
	0xBD, 0x21, 0x02, 0xC9, 0x02, 0xF0, 0x04, 0xA9, 0x30, 0xD0, 0x02, 0xA9,
	0x80, 0x9D, 0x33, 0x02, 0x4C, 0x52, 0x81, 0x29, 0x7F, 0x8C, 0x01, 0x02,
	0xA8, 0x9D, 0x4B, 0x02, 0x9D, 0x45, 0x02, 0xAC, 0x01, 0x02, 0xC8, 0x4C,
	0xBF, 0x80, 0x29, 0x0F, 0x8D, 0x02, 0x02, 0xBD, 0x33, 0x02, 0x29, 0xF0,
	0x0D, 0x02, 0x02, 0x9D, 0x33, 0x02, 0xC8, 0x4C, 0xBF, 0x80, 0x29, 0x03,
	0x2A, 0x2A, 0x2A, 0x2A, 0x2A, 0x2A, 0x8D, 0x02, 0x02, 0xBD, 0x33, 0x02,
	0x29, 0x3F, 0x0D, 0x02, 0x02, 0x9D, 0x33, 0x02, 0xC8, 0x4C, 0xBF, 0x80,
	0x8D, 0x02, 0x02, 0xBD, 0x21, 0x02, 0xC9, 0x03, 0xD0, 0x03, 0x20, 0x61,
	0x81, 0xAD, 0x02, 0x02, 0x8C, 0x01, 0x02, 0x0A, 0xA8, 0xB9, 0x29, 0x82,
	0x9D, 0x39, 0x02, 0xB9, 0x2A, 0x82, 0x9D, 0x3F, 0x02, 0xAC, 0x01, 0x02,
	0x20, 0x77, 0x81, 0xC8, 0x98, 0x18, 0x7D, 0x27, 0x02, 0x9D, 0x27, 0x02,
	0x90, 0x03, 0xFE, 0x2D, 0x02, 0x60
];

const doNoise = [
	// Offset 0x000001E1 to 0x000001F6
	0xAD, 0x02, 0x02, 0x29, 0x10, 0xF0, 0x08, 0xAD, 0x02, 0x02, 0x09, 0x80,
	0x8D, 0x02, 0x02, 0xAD, 0x02, 0x02, 0x9D, 0x39, 0x02, 0x60
];


const checkRest = [
	// Offset 0x000001F7 to 0x0000020C
	0xB1, 0x00, 0xC9, 0x5E, 0xD0, 0x07, 0xBD, 0x1B, 0x02, 0x09, 0x02, 0xD0,
	0x05, 0xBD, 0x1B, 0x02, 0x29, 0xFD, 0x9D, 0x1B, 0x02, 0x60
];

const setTempPorts = [
	// Offset 0x0000020D to 0x00000241
	0xBD, 0x21, 0x02, 0x0A, 0x0A, 0xA8, 0xBD, 0x33, 0x02, 0x99, 0x05, 0x02,
	0xA9, 0x08, 0x99, 0x06, 0x02, 0xBD, 0x39, 0x02, 0x99, 0x07, 0x02, 0xBD,
	0x3F, 0x02, 0x99, 0x08, 0x02, 0xBD, 0x1B, 0x02, 0x29, 0x02, 0xF0, 0x10,
	0xBD, 0x21, 0x02, 0xC9, 0x02, 0xF0, 0x04, 0xA9, 0x30, 0xD0, 0x02, 0xA9,
	0x80, 0x99, 0x05, 0x02, 0x60
];

const setApu = [
	// Offset 0x00000242 to 0x000002A6
	0xAD, 0x05, 0x02, 0x8D, 0x00, 0x40, 0xAD, 0x06, 0x02, 0x8D, 0x01, 0x40,
	0xAD, 0x07, 0x02, 0x8D, 0x02, 0x40, 0xAD, 0x08, 0x02, 0xCD, 0x03, 0x02,
	0xF0, 0x06, 0x8D, 0x03, 0x40, 0x8D, 0x03, 0x02, 0xAD, 0x09, 0x02, 0x8D,
	0x04, 0x40, 0xAD, 0x0A, 0x02, 0x8D, 0x05, 0x40, 0xAD, 0x0B, 0x02, 0x8D,
	0x06, 0x40, 0xAD, 0x0C, 0x02, 0xCD, 0x04, 0x02, 0xF0, 0x06, 0x8D, 0x07,
	0x40, 0x8D, 0x04, 0x02, 0xAD, 0x0D, 0x02, 0x8D, 0x08, 0x40, 0xAD, 0x0F,
	0x02, 0x8D, 0x0A, 0x40, 0xAD, 0x10, 0x02, 0x8D, 0x0B, 0x40, 0xAD, 0x11,
	0x02, 0x8D, 0x0C, 0x40, 0xAD, 0x13, 0x02, 0x8D, 0x0E, 0x40, 0xAD, 0x14,
	0x02, 0x8D, 0x0F, 0x40, 0x60
];


export const nsfDriver = [
	78, 69, 83, 77, 26, 1, 1, 1, 0, 128, 0, 128, 7, 128, 72, 101, 97, 100, 101,
	114, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 66, 111, 98, 98, 105, 32, 84, 111, 119, 101, 114, 115, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 48, 50, 52, 32, 66, 111,
	98, 98, 105, 32, 84, 111, 119, 101, 114, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 255, 64, 0, 0, 0, 0, 0, 0, 0, 0, 29, 78, 3, 0, 0, 0, 0, 0,
	32, 11, 128, 32, 57, 128, 96, 32, 136, 128, 96, 169, 15, 141, 21, 64, 169,
	0, 141, 0, 2, 169, 255, 141, 3, 2, 141, 4, 2, 169, 48, 141, 5, 2, 141, 9, 2,
	141, 17, 2, 169, 128, 141, 13, 2, 96, 169, 0, 141, 21, 64, 169, 1, 141, 0,
	2, 96, 141, 1, 2, 10, 168, 185, 39, 130, 133, 0, 185, 40, 130, 133, 1, 160,
	0, 177, 0, 141, 2, 2, 200, 177, 0, 170, 200, 177, 0, 157, 27, 2, 240, 32,
	200, 177, 0, 157, 33, 2, 200, 177, 0, 157, 51, 2, 200, 177, 0, 157, 39, 2,
	200, 177, 0, 157, 45, 2, 169, 1, 157, 69, 2, 157, 75, 2, 200, 173, 1, 2,
	157, 21, 2, 206, 2, 2, 208, 201, 96, 173, 0, 2, 208, 37, 32, 29, 128, 162,
	0, 189, 27, 2, 41, 1, 240, 17, 222, 69, 2, 208, 9, 189, 75, 2, 157, 69, 2,
	32, 179, 128, 32, 141, 129, 232, 224, 6, 208, 227, 32, 194, 129, 96, 189,
	39, 2, 133, 0, 189, 45, 2, 133, 1, 160, 0, 177, 0, 16, 104, 201, 224, 144,
	35, 201, 240, 144, 50, 201, 244, 144, 66, 189, 27, 2, 41, 254, 157, 27, 2,
	189, 33, 2, 201, 2, 240, 4, 169, 48, 208, 2, 169, 128, 157, 51, 2, 76, 82,
	129, 41, 127, 140, 1, 2, 168, 157, 75, 2, 157, 69, 2, 172, 1, 2, 200, 76,
	191, 128, 41, 15, 141, 2, 2, 189, 51, 2, 41, 240, 13, 2, 2, 157, 51, 2, 200,
	76, 191, 128, 41, 3, 42, 42, 42, 42, 42, 42, 141, 2, 2, 189, 51, 2, 41, 63,
	13, 2, 2, 157, 51, 2, 200, 76, 191, 128, 141, 2, 2, 189, 33, 2, 201, 3, 208,
	3, 32, 97, 129, 173, 2, 2, 140, 1, 2, 10, 168, 185, 41, 130, 157, 57, 2,
	185, 42, 130, 157, 63, 2, 172, 1, 2, 32, 119, 129, 200, 152, 24, 125, 39, 2,
	157, 39, 2, 144, 3, 254, 45, 2, 96, 173, 2, 2, 41, 16, 240, 8, 173, 2, 2, 9,
	128, 141, 2, 2, 173, 2, 2, 157, 57, 2, 96, 177, 0, 201, 94, 208, 7, 189, 27,
	2, 9, 2, 208, 5, 189, 27, 2, 41, 253, 157, 27, 2, 96, 189, 33, 2, 10, 10,
	168, 189, 51, 2, 153, 5, 2, 169, 8, 153, 6, 2, 189, 57, 2, 153, 7, 2, 189,
	63, 2, 153, 8, 2, 189, 27, 2, 41, 2, 240, 16, 189, 33, 2, 201, 2, 240, 4,
	169, 48, 208, 2, 169, 128, 153, 5, 2, 96, 173, 5, 2, 141, 0, 64, 173, 6, 2,
	141, 1, 64, 173, 7, 2, 141, 2, 64, 173, 8, 2, 205, 3, 2, 240, 6, 141, 3, 64,
	141, 3, 2, 173, 9, 2, 141, 4, 64, 173, 10, 2, 141, 5, 64, 173, 11, 2, 141,
	6, 64, 173, 12, 2, 205, 4, 2, 240, 6, 141, 7, 64, 141, 4, 2, 173, 13, 2,
	141, 8, 64, 173, 15, 2, 141, 10, 64, 173, 16, 2, 141, 11, 64, 173, 17, 2,
	141, 12, 64, 173, 19, 2, 141, 14, 64, 173, 20, 2, 141, 15, 64, 96, 231, 130,
	241, 7, 128, 7, 19, 7, 173, 6, 77, 6, 243, 5, 157, 5, 77, 5, 0, 5, 184, 4,
	117, 4, 53, 4, 248, 3, 191, 3, 137, 3, 86, 3, 38, 3, 249, 2, 206, 2, 166, 2,
	127, 2, 92, 2, 58, 2, 26, 2, 251, 1, 223, 1, 196, 1, 171, 1, 147, 1, 124, 1,
	103, 1, 81, 1, 63, 1, 45, 1, 28, 1, 12, 1, 253, 0, 239, 0, 226, 0, 210, 0,
	201, 0, 189, 0, 179, 0, 169, 0, 159, 0, 150, 0, 142, 0, 134, 0, 126, 0, 119,
	0, 112, 0, 106, 0, 100, 0, 94, 0, 89, 0, 84, 0, 79, 0, 75, 0, 70, 0, 66, 0,
	63, 0, 59, 0, 56, 0, 52, 0, 49, 0, 47, 0, 44, 0, 41, 0, 39, 0, 37, 0, 35, 0,
	33, 0, 31, 0, 29, 0, 27, 0, 26, 0, 24, 0, 23, 0, 21, 0, 20, 0, 19, 0, 18, 0,
	17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 12, 0, 11, 0, 10, 0, 10, 0, 9, 0,
	8, 0, 0, 0, 4, 0, 1, 0, 188, 0, 131, 1, 1, 1, 58, 71, 131, 2, 1, 2, 129,
	136, 131, 3, 1, 3, 30, 166, 131, 168, 31, 158, 240, 34, 241, 148, 33, 242,
	31, 243, 30, 240, 31, 241, 33, 242, 223, 243, 94, 168, 94, 33, 240, 158, 36,
	241, 148, 34, 242, 33, 243, 156, 31, 240, 33, 241, 34, 223, 94, 168, 94,
	229, 34, 158, 38, 148, 36, 34, 158, 36, 38, 39, 148, 38, 36, 239, 38, 240,
	36, 34, 33, 30, 31, 33, 34, 33, 31, 218, 94, 255, 148, 19, 94, 26, 94, 26,
	94, 26, 94, 14, 94, 21, 94, 21, 94, 21, 94, 21, 94, 24, 94, 24, 94, 24, 94,
	14, 94, 19, 94, 19, 94, 19, 94, 229, 19, 94, 26, 94, 26, 94, 26, 94, 26, 94,
	24, 94, 22, 94, 21, 94, 239, 148, 19, 94, 26, 94, 24, 94, 21, 94, 19, 94,
	218, 94, 255, 168, 31, 34, 26, 30, 33, 36, 26, 31, 34, 38, 158, 36, 38, 168,
	39, 148, 31, 33, 34, 36, 26, 27, 29, 30, 24, 31, 218, 94, 255, 144, 13, 94,
	7, 94, 13, 255
];

